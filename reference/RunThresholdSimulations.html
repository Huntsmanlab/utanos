<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Runs simulations to obtain a list of possible thresholds from the segment ratio differences — RunThresholdSimulations • utanos</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Runs simulations to obtain a list of possible thresholds from the segment ratio differences — RunThresholdSimulations"><meta name="description" content="At each simulation:
Takes a random number of samples from all_ratio_differences (the batch)
Passes this batch to GetCriticalPoints to estimate (via KDE) the batch's density minima/maxima
Adds the minima as a possible threshold if it meets certain criteria. Most specifically, a local minima from a batch
is considered a valid possible threshold if the difference between the distance between first maxima and the minima, and the
second maxima and the minima, are 'close' to each other. If first round, this closeness is &amp;lt; 0.10 distance-wise. If second_round,
this closeness is &amp;lt; 0.05 distance-wise. So, for the second round, we really care about the minima being very close to the two
neighboring maxima. The point of these tolerances is that we do not get a 'low' and a 'flat' local minima, meaning that it is a ratio_median
difference that's not very common. This would affect the rest of the algorithm as not many segments would meet this threshold.
Once simulations are done and we have a list of possible thresholds, we return the threshold (mean of list)

"><meta property="og:description" content="At each simulation:
Takes a random number of samples from all_ratio_differences (the batch)
Passes this batch to GetCriticalPoints to estimate (via KDE) the batch's density minima/maxima
Adds the minima as a possible threshold if it meets certain criteria. Most specifically, a local minima from a batch
is considered a valid possible threshold if the difference between the distance between first maxima and the minima, and the
second maxima and the minima, are 'close' to each other. If first round, this closeness is &amp;lt; 0.10 distance-wise. If second_round,
this closeness is &amp;lt; 0.05 distance-wise. So, for the second round, we really care about the minima being very close to the two
neighboring maxima. The point of these tolerances is that we do not get a 'low' and a 'flat' local minima, meaning that it is a ratio_median
difference that's not very common. This would affect the rest of the algorithm as not many segments would meet this threshold.
Once simulations are done and we have a list of possible thresholds, we return the threshold (mean of list)

"><meta property="og:image" content="https://huntsmanlab.github.io/utanos/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">utanos</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/utanos.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/0_quickstart-vignette.html">0. utanos quickstart guide</a></li>
    <li><a class="dropdown-item" href="../articles/1_samplequality-vignette.html">1. Sample Filtering and Quality Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/2_cndiversityandscaling-vignette.html">2. Investigating Copy-Number Diversity</a></li>
    <li><a class="dropdown-item" href="../articles/3_cnsignatures-vignette.html">3. Investigating and Creating Copy-Number Signatures</a></li>
    <li><a class="dropdown-item" href="../articles/4_shallowhrd-vignette.html">4. Predicting Homologous Recombination Deficiency (HRD)</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Runs simulations to obtain a list of possible thresholds from the segment ratio differences</h1>

      <div class="d-none name"><code>RunThresholdSimulations.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>At each simulation:</p><ul><li><p>Takes a random number of samples from all_ratio_differences (the batch)</p></li>
<li><p>Passes this batch to GetCriticalPoints to estimate (via KDE) the batch's density minima/maxima</p></li>
<li><p>Adds the minima as a possible threshold if it meets certain criteria. Most specifically, a local minima from a batch
is considered a valid possible threshold if the difference between the distance between first maxima and the minima, and the
second maxima and the minima, are 'close' to each other. If first round, this closeness is &lt; 0.10 distance-wise. If second_round,
this closeness is &lt; 0.05 distance-wise. So, for the second round, we really care about the minima being very close to the two
neighboring maxima. The point of these tolerances is that we do not get a 'low' and a 'flat' local minima, meaning that it is a ratio_median
difference that's not very common. This would affect the rest of the algorithm as not many segments would meet this threshold.
Once simulations are done and we have a list of possible thresholds, we return the threshold (mean of list)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RunThresholdSimulations</span><span class="op">(</span></span>
<span>  num_simulations <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  <span class="va">all_ratio_differences</span>,</span>
<span>  second_round <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">seed</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-num-simulations">num_simulations<a class="anchor" aria-label="anchor" href="#arg-num-simulations"></a></dt>
<dd><p>An integer: the number of simulations to run on all_ratio_differences. Set to 100,000
by default</p></dd>


<dt id="arg-all-ratio-differences">all_ratio_differences<a class="anchor" aria-label="anchor" href="#arg-all-ratio-differences"></a></dt>
<dd><p>An array with all the differences of ratio medians between all segment-pairs in the data set</p></dd>


<dt id="arg-second-round">second_round<a class="anchor" aria-label="anchor" href="#arg-second-round"></a></dt>
<dd><p>A boolean. False if first round of simulation, True if second round. This should be set to True once
the simulations have been ran before and we already have a possible THR that we want to re-calibrate with new differences
of ratio medians (i.e. with updated segments, such as post-merging). Set to False by default.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>A seed to use for random number generation. Ensures reproducibility between runs.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxwell Douglas, Branden Lynch, Carlos Vasquez, Jacky Yiu, Ding Ma, Nirupama Tamvada, Sameer Shankar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

