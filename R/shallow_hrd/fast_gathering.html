<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<style>body{background-color:white;}</style>
<script src="lib/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="lib/jquery-1.11.1/jquery.min.js"></script>
<script src="lib/highlight-8.9.1/highlight.min.js"></script>
<script src="lib/difflib-1/difflib.js"></script>
<link href="lib/codediff-1/codediff.css" rel="stylesheet" />
<link href="lib/codediff-1/googlecode.css" rel="stylesheet" />
<script src="lib/codediff-1/codediff.js"></script>
<script src="lib/diffr-binding-0.1/diffr.js"></script>

</head>
<body>
<div id="htmlwidget_container">
  <div class="diffr html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8dbecb24d207105c4de3" style="width:960px;height:500px;"></div>
</div>
<script type="application/json" data-for="htmlwidget-8dbecb24d207105c4de3">{"x":{"message":["function (..., domain = NULL, appendLF = TRUE) ","{","    cond <- if (...length() == 1L && inherits(..1, \"condition\")) {","        if (nargs() > 1L) ","            warning(\"additional arguments ignored in message()\")","        ..1","    }","    else {","        msg <- .makeMessage(..., domain = domain, appendLF = appendLF)","        call <- sys.call()","        simpleMessage(msg, call)","    }","    defaultHandler <- function(c) {","        cat(conditionMessage(c), file = stderr(), sep = \"\")","    }","    withRestarts({","        signalCondition(cond)","        defaultHandler(cond)","    }, muffleMessage = function() NULL)","    invisible()","}"],"contextSize":3,"minJumpSize":10,"wordWrap":true,"file1":"v1.R","file2":"v2.R","f1":"##### Fast gathering 1 #####\ncat(\"Fast gathering segments 1... \\n\")\n\ndataTable <- read.table(paste0(inputPath,\"/\",NAMEEE,\".bam_ratio.txt\"), header = TRUE)\ndataTable = dataTable[,1:4] # dropping CopyNumber\ndataTable[,1] <- gsub('X','23',dataTable[,1]) # substituting X to 23\n\ndataTable = dataTable[which(!dataTable[,1] == \"Y\"),] \n\ndataTable[,1] = as.numeric(as.character(dataTable[,1]))\n\ndataTable = dataTable[order(dataTable[,1]),]\n\nL = dim(dataTable)[1] # number of rows\nprint(dataTable[1:2,])\nsize_window = dataTable[2,2] - dataTable[1,2]\n\ndataTable = cbind(1:L, dataTable[,1], dataTable[,2], dataTable[,2]+size_window-1, \n                  dataTable[,3], dataTable[,4]) \ndataTable = as.data.frame(dataTable)\ncolnames(dataTable) = c(\"feature\", \"chromosome\", \"start\", \"end\", \"ratio\", \"ratio_median\")\ndataTable = dataTable[which(!dataTable$ratio == -1),]\n\n\n\ndataTable = dataTable[which(!dataTable$ratio_median == -1),]\n\n# log2 transformation\ndataTable[,5] = log2(dataTable[,5])\ndataTable[,6] = log2(dataTable[,6])\n#print(dataTable[1:50,])\n\n## Up until here they've \"cleaned up\" the frame, added an \"end\" column by using the size window (length of a band)\n## and log-transformed\n\nratio <- data.frame(dataTable) # copy of dataTable\n\nshort_size_window = size_window/1000\n\nX=ratio # this is pretty much a copy of dataTable\n#print(X[1:5,])\nratio_file_tsv = ratio # save in the moment <- this is not my comment. \nwrite.table(ratio_file_tsv, file = paste0(outputPath,\"/\",NAMEEE,\"_ratio_file_tsv.txt\"), sep=\"\\t\", row.names = FALSE)\n\n# UNTIL HERE IS GetCleanBamRatiosFrame\nX=X[,-1] # feature # dropping 1st column (feature)\n\n\n\nX=X[,-4] # dropping 4th column (ratio)\n#print(X[1:50,])\n\n## Remove spurious regions based on telomere and centromere from UCSC\n\nX <- X[which(!(X[,1]==1 & X[,2]>=0 & X[,3]<=10000)),] # telomere\nX <- X[which(!(X[,1]==1 & X[,2]>=121535434 & X[,3]<=124535434)),] # centromere\nX <- X[which(!(X[,1]==1 & X[,2]>=249240621 & X[,3]<=249250621)),] # telomere\nX <- X[which(!(X[,1]==2 & X[,2]>=0 & X[,3]<=10000)),] # telomere\nX <- X[which(!(X[,1]==2 & X[,2]>=92326171 & X[,3]<=95326171)),] # centromere\nX <- X[which(!(X[,1]==2 & X[,2]>=243189373 & X[,3]<=243199373)),] # telomere\nX <- X[which(!(X[,1]==3 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==3 & X[,2]>=90504854 & X[,3]<=93504854)),]\nX <- X[which(!(X[,1]==3 & X[,2]>=198012430 & X[,3]<=198022430)),]\nX <- X[which(!(X[,1]==4 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==4 & X[,2]>=49660117 & X[,3]<=52660117)),]\nX <- X[which(!(X[,1]==4 & X[,2]>=191144276 & X[,3]<=191154276)),]\nX <- X[which(!(X[,1]==5 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==5 & X[,2]>=46405641 & X[,3]<=9405641)),]\nX <- X[which(!(X[,1]==5 & X[,2]>=180905260 & X[,3]<=180915260)),]\nX <- X[which(!(X[,1]==6 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==6 & X[,2]>=58830166 & X[,3]<=61830166)),]\nX <- X[which(!(X[,1]==6 & X[,2]>=171105067 & X[,3]<=171115067)),]\nX <- X[which(!(X[,1]==7 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==7 & X[,2]>=58054331 & X[,3]<=61054331)),]\nX <- X[which(!(X[,1]==7 & X[,2]>=159128663 & X[,3]<=159138663)),]\nX <- X[which(!(X[,1]==8 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==8 & X[,2]>=43838887 & X[,3]<=46838887)),]\nX <- X[which(!(X[,1]==8 & X[,2]>=146354022 & X[,3]<=146364022)),]\nX <- X[which(!(X[,1]==9 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==9 & X[,2]>=47367679 & X[,3]<=50367679)),]\nX <- X[which(!(X[,1]==9 & X[,2]>=141203431 & X[,3]<=141213431)),]\n\n\nX <- X[which(!(X[,1]==10 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==10 & X[,2]>=39254935 & X[,3]<=42254935)),]\nX <- X[which(!(X[,1]==10 & X[,2]>=135524747 & X[,3]<=135534747)),]\nX <- X[which(!(X[,1]==11 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==11 & X[,2]>=51644205 & X[,3]<=54644205)),]\nX <- X[which(!(X[,1]==11 & X[,2]>=134996516 & X[,3]<=135006516)),]\nX <- X[which(!(X[,1]==12 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==12 & X[,2]>=34856694 & X[,3]<=37856694)),]\nX <- X[which(!(X[,1]==12 & X[,2]>=133841895 & X[,3]<=133851895)),]\nX <- X[which(!(X[,1]==13 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==13 & X[,2]>=16000000 & X[,3]<=19000000)),]\nX <- X[which(!(X[,1]==13 & X[,2]>=115159878 & X[,3]<=115169878)),]\nX <- X[which(!(X[,1]==14 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==14 & X[,2]>=16000000 & X[,3]<=19000000)),]\nX <- X[which(!(X[,1]==14 & X[,2]>=107339540 & X[,3]<=107349540)),]\nX <- X[which(!(X[,1]==15 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==15 & X[,2]>=17000000 & X[,3]<=20000000)),]\nX <- X[which(!(X[,1]==15 & X[,2]>=102521392 & X[,3]<=102531392)),]\nX <- X[which(!(X[,1]==16 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==16 & X[,2]>=35335801 & X[,3]<=38335801)),]\nX <- X[which(!(X[,1]==16 & X[,2]>=90344753 & X[,3]<=90354753)),]\nX <- X[which(!(X[,1]==17 & X[,2]>=22263006 & X[,3]<=25263006)),]\nX <- X[which(!(X[,1]==18 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==18 & X[,2]>=15460898 & X[,3]<=18460898)),]\nX <- X[which(!(X[,1]==18 & X[,2]>=78067248 & X[,3]<=78077248)),]\nX <- X[which(!(X[,1]==19 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==19 & X[,2]>=24681782 & X[,3]<=27681782)),]\nX <- X[which(!(X[,1]==19 & X[,2]>=59118983 & X[,3]<=59128983)),]\nX <- X[which(!(X[,1]==20 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==20 & X[,2]>=26369569 & X[,3]<=29369569)),]\nX <- X[which(!(X[,1]==20 & X[,2]>=63015520 & X[,3]<=63025520)),]\nX <- X[which(!(X[,1]==21 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==21 & X[,2]>=11288129 & X[,3]<=14288129)),]\nX <- X[which(!(X[,1]==21 & X[,2]>=48119895 & X[,3]<=48129895)),]\nX <- X[which(!(X[,1]==22 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==22 & X[,2]>=13000000 & X[,3]<=16000000)),]\nX <- X[which(!(X[,1]==22 & X[,2]>=51294566 & X[,3]<=51304566)),]\nX <- X[which(!(X[,1]==23 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==23 & X[,2]>=58100000 & X[,3]<=63800000)),]\nX <- X[which(!(X[,1]==23 & X[,2]>=155260560 & X[,3]<=155270560)),]\n\n## Add chromosome arm \n\n#options(show.error.messages = FALSE)\n\nX$chr_arm <- rep(0,nrow(X))\ncolnames(X) <- c(\"chr\", \"start\", \"end\", \"ratio_median\", \"chr_arm\")\nX=X[c(\"chr\", \"chr_arm\", \"start\", \"end\", \"ratio_median\")]\n\nX[,3]=as.numeric(as.character(X[,3])) \nX[,4]=as.numeric(as.character(X[,4])) \n\ntt <- X[,1] == 1 & X[,3] < 125000000 & X[,4] < 125000000\nX[tt,2] = 1\ntt <- X[,1] == 1 & X[,3] > 125000000 & X[,4] > 125000000\nX[tt,2] = 2\ntt <- X[,1] == 1 & X[,3] < 125000000 & X[,4] > 125000000\nX[tt,2] = 1\n\nB = X[tt,4]\nX[tt,4] = 125000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 125000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 2 & X[,3] < 93300000 & X[,4] < 93300000\nX[tt,2] = 1\ntt <- X[,1] == 2 & X[,3] > 93300000 & X[,4] > 93300000\nX[tt,2] = 2\ntt <- X[,1] == 2 & X[,3] < 93300000 & X[,4] > 93300000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 93300000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 93300001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 3 & X[,3] < 91000000 & X[,4] < 91000000\nX[tt,2] = 1\ntt <- X[,1] == 3 & X[,3] > 91000000 & X[,4] > 91000000\nX[tt,2] = 2\ntt <- X[,1] == 3 & X[,3] < 91000000 & X[,4] > 91000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 91000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 91000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 4 & X[,3] < 50400000 & X[,4] < 50400000\nX[tt,2] = 1\ntt <- X[,1] == 4 & X[,3] > 50400000 & X[,4] > 50400000\nX[tt,2] = 2\ntt <- X[,1] == 4 & X[,3] < 50400000 & X[,4] > 50400000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 50400000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 50400001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 5 & X[,3] < 48400000 & X[,4] < 48400000\nX[tt,2] = 1\ntt <- X[,1] == 5 & X[,3] > 48400000 & X[,4] > 48400000\nX[tt,2] = 2\ntt <- X[,1] == 5 & X[,3] < 48400000 & X[,4] > 48400000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 48400000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 48400001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 6 & X[,3] < 61000000 & X[,4] < 61000000\nX[tt,2] = 1\ntt <- X[,1] == 6 & X[,3] > 61000000 & X[,4] > 61000000\nX[tt,2] = 2\ntt <- X[,1] == 6 & X[,3] < 61000000 & X[,4] > 61000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 61000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 61000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 7 & X[,3] < 59900000 & X[,4] < 59900000\nX[tt,2] = 1\ntt <- X[,1] == 7 & X[,3] > 59900000 & X[,4] > 59900000\nX[tt,2] = 2\ntt <- X[,1] == 7 & X[,3] < 59900000 & X[,4] > 59900000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 59900000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 59900001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 8 & X[,3] < 45600000 & X[,4] < 45600000\nX[tt,2] = 1\ntt <- X[,1] == 8 & X[,3] > 45600000 & X[,4] > 45600000\nX[tt,2] = 2\ntt <- X[,1] == 8 & X[,3] < 45600000 & X[,4] > 45600000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 45600000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 45600001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 9 & X[,3] < 49000000 & X[,4] < 49000000\nX[tt,2] = 1\n\ntt <- X[,1] == 9 & X[,4] > 49000000 & X[,4] > 49000000\nX[tt,2] = 2\ntt <- X[,1] == 9 & X[,3] < 49000000 & X[,4] > 49000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 49000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 49000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 10 & X[,3] < 40200000 & X[,4] < 40200000\nX[tt,2] = 1\ntt <- X[,1] == 10 & X[,3] > 40200000 & X[,4] > 40200000\nX[tt,2] = 2\ntt <- X[,1] == 10 & X[,3] < 40200000 & X[,4] > 40200000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 40200000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 40200001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 11 & X[,3] < 53700000 & X[,4] < 53700000\nX[tt,2] = 1\ntt <- X[,1] == 11 & X[,3] > 53700000 & X[,4] > 53700000\nX[tt,2] = 2\ntt <- X[,1] == 11 & X[,3] < 53700000 & X[,4] > 53700000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 53700000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 53700001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 12 & X[,3] < 35800000 & X[,4] < 35800000\nX[tt,2] = 1\ntt <- X[,1] == 12 & X[,3] > 35800000 & X[,4] > 35800000\nX[tt,2] = 2\ntt <- X[,1] == 12 & X[,3] < 35800000 & X[,4] > 35800000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 35800000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 35800001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 13 & X[,3] < 17900000 & X[,4] < 17900000\nX[tt,2] = 1\ntt <- X[,1] == 13 & X[,3] > 17900000 & X[,4] > 17900000\nX[tt,2] = 2\ntt <- X[,1] == 13 & X[,3] < 17900000 & X[,4] > 17900000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 17900000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 17900001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 14 & X[,3] < 17600000 & X[,4] < 17600000\nX[tt,2] = 1\ntt <- X[,1] == 14 & X[,3] > 17600000 & X[,4] > 17600000\nX[tt,2] = 2\ntt <- X[,1] == 14 & X[,3] < 17600000 & X[,4] > 17600000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 17600000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 17600001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 15 & X[,3] < 19000000 & X[,4] < 19000000\nX[tt,2] = 1\ntt <- X[,1] == 15 & X[,3] > 19000000 & X[,4] > 19000000\nX[tt,2] = 2\ntt <- X[,1] == 15 & X[,3] < 19000000 & X[,4] > 19000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 19000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 19000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 16 & X[,3] < 36600000 & X[,4] < 36600000\nX[tt,2] = 1\ntt <- X[,1] == 16 & X[,3] > 36600000 & X[,4] > 36600000\nX[tt,2] = 2\ntt <- X[,1] == 16 & X[,3] < 36600000 & X[,4] > 36600000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 36600000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 36600001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 17 & X[,3] < 24000000 & X[,4] < 24000000\nX[tt,2] = 1\ntt <- X[,1] == 17 & X[,3] > 24000000 & X[,4] > 24000000\nX[tt,2] = 2\ntt <- X[,1] == 17 & X[,3] < 24000000 & X[,4] > 24000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 24000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 24000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 18 & X[,3] < 17200000 & X[,4] < 17200000\nX[tt,2] = 1\ntt <- X[,1] == 18 & X[,3] > 17200000 & X[,4] > 17200000\nX[tt,2] = 2\ntt <- X[,1] == 18 & X[,3] < 17200000 & X[,4] > 17200000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 17200000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 17200001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 19 & X[,3] < 26500000 & X[,4] < 26500000\nX[tt,2] = 1\ntt <- X[,1] == 19 & X[,3] > 26500000 & X[,4] > 26500000\nX[tt,2] = 2\ntt <- X[,1] == 19 & X[,3] < 26500000 & X[,4] > 26500000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 26500000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 26500001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 20 & X[,3] < 27500000 & X[,4] < 27500000\nX[tt,2] = 1\ntt <- X[,1] == 20 & X[,3] > 27500000 & X[,4] > 27500000\nX[tt,2] = 2\ntt <- X[,1] == 20 & X[,3] < 27500000 & X[,4] > 27500000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 27500000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 27500001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 21 & X[,3] < 13200000 & X[,4] < 13200000\nX[tt,2] = 1\ntt <- X[,1] == 21 & X[,3] > 13200000 & X[,4] > 13200000\nX[tt,2] = 2\ntt <- X[,1] == 21 & X[,3] < 13200000 & X[,4] > 13200000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 13200000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 13200001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 22 & X[,3] < 14700000 & X[,4] < 14700000\nX[tt,2] = 1\ntt <- X[,1] == 22 & X[,3] > 14700000 & X[,4] > 14700000\nX[tt,2] = 2\ntt <- X[,1] == 22 & X[,3] < 14700000 & X[,4] > 14700000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 14700000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 14700001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\n\ntt <- X[,1] == 23 & X[,3] < 60950000 & X[,4] < 60950000\nX[tt,2] = 1\ntt <- X[,1] == 23 & X[,3] > 60950000 & X[,4] > 60950000\nX[tt,2] = 2\ntt <- X[,1] == 23 & X[,3] < 60950000 & X[,4] > 60950000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 60950000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 60950000, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\n\nX[,2]<-X[,1]+(X[,2]-1)/2      \n\ntt=which(X$ratio_median==-Inf)\n\nif (length(tt) >= 1){\n  X=X[-tt,]  \n}\n\n\n\nX=as.matrix(X)\n\nL = dim(X)[1] # number of rows/samples\nA = matrix(0, ncol=6, nrow=L)\n\ni=1    \nc=1    \n\nwhile (i < L){\n  if(X[i,2]==X[i+1,2]){ # if in the same chr_arm             \n    if (X[i,5]==X[i+1,5]){ # if same ratio_median\n      n=1\n      while (X[i,2]==X[i+n,2] & X[i,5]==X[i+n,5] & i+n < L){ # while i and i + n are in same arm, have same ratio_median, and i+n is still within the # of rows\n        n=n+1 # keep searching for the row where one of these rules is broken\n      }\n      if(i+n == L){ # if we reach the last sample \n        A[c,]=c(X[i,1], X[i,2], X[i,3], X[i+n,4], X[i,5], X[i+n,4]-X[i,3]+1)  \n        i=i+n\n        c=c+1\n      }\n      else{\n        A[c,]=c(X[i,1], X[i,2], X[i,3], X[i+n-1,4], X[i,5], X[i+n-1,4]-X[i,3]+1) # c'th row has data of this \"band\" that has the same ratio_median:\n        # i's chr, i's chr_arm, i's start position, i  + (n-1)'s end: n-1 because n is where we've already changed ratio_median, so n-1 is the last row within this \"band\"\n        # that have the same ratio_median, i's ratio_median, size: i + (n-1)'s end - i's start\n        \n        # so, for a continuous section of rows that have the same ratio_median, A's c-th row is:\n        # chr, arm, start, end, ratio_median, size\n        i=i+n\n        c=c+1\n      }\n    } # same chr_arm, different ratio_median\n    else{\n      # so if i and i+1 are in same arm but have different ratio_median's, then we keep i's data into A\n      A[c,]=c(X[i,1], X[i,2], X[i,3], X[i,4], X[i,5], X[i,4]-X[i,3]+1)\n      i=i+1\n      c=c+1\n    }\n  }\n  else{ # different chr_arm\n    # same as above\n    A[c,]=c(X[i,1], X[i,2], X[i,3], X[i,4], X[i,5], X[i,4]-X[i,3]+1)\n    i=i+1                                        \n    c=c+1                         \n  }  \n}\n\nA=subset(A, A[,1] != 0)\nrownames(A) <- NULL \ncolnames(A) <- c(\"chr\", \"chr_arm\", \"start\", \"end\", \"ratio_median\", \"size\")\n\n\nwrite.table(A, file = paste0(outputPath,\"/\",NAMEEE,\"_ratio_median_gathered.txt\"), sep = \"\\t\", row.names = FALSE)\n\noptions(show.error.messages = TRUE)\n\n# UNTIL HERE is gathered_by_ratio_median","f2":"##### NEW Fast gathering 2 #####\n\ncat(\"Find fast gathering 2... \\n\")\n\ndataTable <- read.table(paste0(inputPath,\"/\",NAMEEE,\".bam_ratio.txt\"), header = TRUE)\ndataTable = dataTable[,1:4]\n\ndataTable[,1] <- gsub('X','23',dataTable[,1])\n\ndataTable = dataTable[which(!dataTable[,1] == \"Y\"),] \n\ndataTable[,1] = as.numeric(as.character(dataTable[,1]))\n\ndataTable = dataTable[order(dataTable[,1]),]\n\nL = dim(dataTable)[1]\n\nsize_window = dataTable[2,2] - dataTable[1,2]\n\ndataTable = cbind(1:L, dataTable[,1], dataTable[,2], dataTable[,2]+size_window-1, \n                  dataTable[,3], dataTable[,4]) \n\ndataTable = as.data.frame(dataTable)\ncolnames(dataTable) = c(\"feature\", \"chromosome\", \"start\", \"end\", \"ratio\", \"ratio_median\")\n\ndataTable = dataTable[which(!dataTable$ratio == -1),]\ndataTable = dataTable[which(!dataTable$ratio_median == -1),]\n\n# log2 transformation\ndataTable[,5] = log2(dataTable[,5])\ndataTable[,6] = log2(dataTable[,6])\n\nratio <- data.frame(dataTable)\n\nshort_size_window = size_window/1000\n\nX=ratio\n\nratio_file_tsv = ratio # save for later\n\nX=X[,-1] # feature\nX=X[,-4] \n\n\n## Remove spurious regions based on telomere and centromere from UCSC\n\nX <- X[which(!(X[,1]==1 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==1 & X[,2]>=121535434 & X[,3]<=124535434)),]\nX <- X[which(!(X[,1]==1 & X[,2]>=249240621 & X[,3]<=249250621)),]\nX <- X[which(!(X[,1]==2 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==2 & X[,2]>=92326171 & X[,3]<=95326171)),]\nX <- X[which(!(X[,1]==2 & X[,2]>=243189373 & X[,3]<=243199373)),]\nX <- X[which(!(X[,1]==3 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==3 & X[,2]>=90504854 & X[,3]<=93504854)),]\nX <- X[which(!(X[,1]==3 & X[,2]>=198012430 & X[,3]<=198022430)),]\nX <- X[which(!(X[,1]==4 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==4 & X[,2]>=49660117 & X[,3]<=52660117)),]\nX <- X[which(!(X[,1]==4 & X[,2]>=191144276 & X[,3]<=191154276)),]\nX <- X[which(!(X[,1]==5 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==5 & X[,2]>=46405641 & X[,3]<=9405641)),]\nX <- X[which(!(X[,1]==5 & X[,2]>=180905260 & X[,3]<=180915260)),]\nX <- X[which(!(X[,1]==6 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==6 & X[,2]>=58830166 & X[,3]<=61830166)),]\nX <- X[which(!(X[,1]==6 & X[,2]>=171105067 & X[,3]<=171115067)),]\nX <- X[which(!(X[,1]==7 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==7 & X[,2]>=58054331 & X[,3]<=61054331)),]\nX <- X[which(!(X[,1]==7 & X[,2]>=159128663 & X[,3]<=159138663)),]\nX <- X[which(!(X[,1]==8 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==8 & X[,2]>=43838887 & X[,3]<=46838887)),]\nX <- X[which(!(X[,1]==8 & X[,2]>=146354022 & X[,3]<=146364022)),]\nX <- X[which(!(X[,1]==9 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==9 & X[,2]>=47367679 & X[,3]<=50367679)),]\nX <- X[which(!(X[,1]==9 & X[,2]>=141203431 & X[,3]<=141213431)),]\nX <- X[which(!(X[,1]==10 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==10 & X[,2]>=39254935 & X[,3]<=42254935)),]\nX <- X[which(!(X[,1]==10 & X[,2]>=135524747 & X[,3]<=135534747)),]\nX <- X[which(!(X[,1]==11 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==11 & X[,2]>=51644205 & X[,3]<=54644205)),]\nX <- X[which(!(X[,1]==11 & X[,2]>=134996516 & X[,3]<=135006516)),]\nX <- X[which(!(X[,1]==12 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==12 & X[,2]>=34856694 & X[,3]<=37856694)),]\nX <- X[which(!(X[,1]==12 & X[,2]>=133841895 & X[,3]<=133851895)),]\nX <- X[which(!(X[,1]==13 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==13 & X[,2]>=16000000 & X[,3]<=19000000)),]\nX <- X[which(!(X[,1]==13 & X[,2]>=115159878 & X[,3]<=115169878)),]\nX <- X[which(!(X[,1]==14 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==14 & X[,2]>=16000000 & X[,3]<=19000000)),]\nX <- X[which(!(X[,1]==14 & X[,2]>=107339540 & X[,3]<=107349540)),]\nX <- X[which(!(X[,1]==15 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==15 & X[,2]>=17000000 & X[,3]<=20000000)),]\nX <- X[which(!(X[,1]==15 & X[,2]>=102521392 & X[,3]<=102531392)),]\nX <- X[which(!(X[,1]==16 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==16 & X[,2]>=35335801 & X[,3]<=38335801)),]\nX <- X[which(!(X[,1]==16 & X[,2]>=90344753 & X[,3]<=90354753)),]\nX <- X[which(!(X[,1]==17 & X[,2]>=22263006 & X[,3]<=25263006)),]\nX <- X[which(!(X[,1]==18 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==18 & X[,2]>=15460898 & X[,3]<=18460898)),]\nX <- X[which(!(X[,1]==18 & X[,2]>=78067248 & X[,3]<=78077248)),]\nX <- X[which(!(X[,1]==19 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==19 & X[,2]>=24681782 & X[,3]<=27681782)),]\nX <- X[which(!(X[,1]==19 & X[,2]>=59118983 & X[,3]<=59128983)),]\nX <- X[which(!(X[,1]==20 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==20 & X[,2]>=26369569 & X[,3]<=29369569)),]\nX <- X[which(!(X[,1]==20 & X[,2]>=63015520 & X[,3]<=63025520)),]\nX <- X[which(!(X[,1]==21 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==21 & X[,2]>=11288129 & X[,3]<=14288129)),]\nX <- X[which(!(X[,1]==21 & X[,2]>=48119895 & X[,3]<=48129895)),]\nX <- X[which(!(X[,1]==22 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==22 & X[,2]>=13000000 & X[,3]<=16000000)),]\nX <- X[which(!(X[,1]==22 & X[,2]>=51294566 & X[,3]<=51304566)),]\n\nX <- X[which(!(X[,1]==23 & X[,2]>=0 & X[,3]<=10000)),]\nX <- X[which(!(X[,1]==23 & X[,2]>=58100000 & X[,3]<=63800000)),]\nX <- X[which(!(X[,1]==23 & X[,2]>=155260560 & X[,3]<=155270560)),]\n\n\n## Add chromosome arm \n\noptions(show.error.messages = FALSE)\n\nX$chr_arm <- rep(0,nrow(X))\ncolnames(X) <- c(\"chr\", \"start\", \"end\", \"ratio_median\", \"chr_arm\")\nX=X[c(\"chr\", \"chr_arm\", \"start\", \"end\", \"ratio_median\")]\n\nX[,3]=as.numeric(as.character(X[,3])) \nX[,4]=as.numeric(as.character(X[,4])) \n\ntt <- X[,1] == 1 & X[,3] < 125000000 & X[,4] < 125000000\nX[tt,2] = 1\ntt <- X[,1] == 1 & X[,3] > 125000000 & X[,4] > 125000000\nX[tt,2] = 2\ntt <- X[,1] == 1 & X[,3] < 125000000 & X[,4] > 125000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 125000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 125000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])  \nrownames(X) <- NULL \n\ntt <- X[,1] == 2 & X[,3] < 93300000 & X[,4] < 93300000\nX[tt,2] = 1\ntt <- X[,1] == 2 & X[,3] > 93300000 & X[,4] > 93300000\nX[tt,2] = 2\ntt <- X[,1] == 2 & X[,3] < 93300000 & X[,4] > 93300000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 93300000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 93300001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 3 & X[,3] < 91000000 & X[,4] < 91000000\nX[tt,2] = 1\ntt <- X[,1] == 3 & X[,3] > 91000000 & X[,4] > 91000000\nX[tt,2] = 2\ntt <- X[,1] == 3 & X[,3] < 91000000 & X[,4] > 91000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 91000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 91000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 4 & X[,3] < 50400000 & X[,4] < 50400000\nX[tt,2] = 1\ntt <- X[,1] == 4 & X[,3] > 50400000 & X[,4] > 50400000\nX[tt,2] = 2\ntt <- X[,1] == 4 & X[,3] < 50400000 & X[,4] > 50400000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 50400000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 50400001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 5 & X[,3] < 48400000 & X[,4] < 48400000\nX[tt,2] = 1\ntt <- X[,1] == 5 & X[,3] > 48400000 & X[,4] > 48400000\nX[tt,2] = 2\ntt <- X[,1] == 5 & X[,3] < 48400000 & X[,4] > 48400000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 48400000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 48400001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 6 & X[,3] < 61000000 & X[,4] < 61000000\nX[tt,2] = 1\ntt <- X[,1] == 6 & X[,3] > 61000000 & X[,4] > 61000000\nX[tt,2] = 2\ntt <- X[,1] == 6 & X[,3] < 61000000 & X[,4] > 61000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 61000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 61000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 7 & X[,3] < 59900000 & X[,4] < 59900000\nX[tt,2] = 1\ntt <- X[,1] == 7 & X[,3] > 59900000 & X[,4] > 59900000\nX[tt,2] = 2\ntt <- X[,1] == 7 & X[,3] < 59900000 & X[,4] > 59900000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 59900000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 59900001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 8 & X[,3] < 45600000 & X[,4] < 45600000\nX[tt,2] = 1\ntt <- X[,1] == 8 & X[,3] > 45600000 & X[,4] > 45600000\nX[tt,2] = 2\ntt <- X[,1] == 8 & X[,3] < 45600000 & X[,4] > 45600000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 45600000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 45600001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 9 & X[,3] < 49000000 & X[,4] < 49000000\nX[tt,2] = 1\ntt <- X[,1] == 9 & X[,4] > 49000000 & X[,4] > 49000000\nX[tt,2] = 2\ntt <- X[,1] == 9 & X[,3] < 49000000 & X[,4] > 49000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 49000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 49000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 10 & X[,3] < 40200000 & X[,4] < 40200000\nX[tt,2] = 1\ntt <- X[,1] == 10 & X[,3] > 40200000 & X[,4] > 40200000\nX[tt,2] = 2\ntt <- X[,1] == 10 & X[,3] < 40200000 & X[,4] > 40200000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 40200000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 40200001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 11 & X[,3] < 53700000 & X[,4] < 53700000\nX[tt,2] = 1\ntt <- X[,1] == 11 & X[,3] > 53700000 & X[,4] > 53700000\nX[tt,2] = 2\ntt <- X[,1] == 11 & X[,3] < 53700000 & X[,4] > 53700000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 53700000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 53700001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 12 & X[,3] < 35800000 & X[,4] < 35800000\nX[tt,2] = 1\ntt <- X[,1] == 12 & X[,3] > 35800000 & X[,4] > 35800000\nX[tt,2] = 2\ntt <- X[,1] == 12 & X[,3] < 35800000 & X[,4] > 35800000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 35800000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 35800001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 13 & X[,3] < 17900000 & X[,4] < 17900000\nX[tt,2] = 1\ntt <- X[,1] == 13 & X[,3] > 17900000 & X[,4] > 17900000\nX[tt,2] = 2\ntt <- X[,1] == 13 & X[,3] < 17900000 & X[,4] > 17900000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 17900000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 17900001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 14 & X[,3] < 17600000 & X[,4] < 17600000\nX[tt,2] = 1\ntt <- X[,1] == 14 & X[,3] > 17600000 & X[,4] > 17600000\nX[tt,2] = 2\ntt <- X[,1] == 14 & X[,3] < 17600000 & X[,4] > 17600000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 17600000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 17600001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 15 & X[,3] < 19000000 & X[,4] < 19000000\nX[tt,2] = 1\ntt <- X[,1] == 15 & X[,3] > 19000000 & X[,4] > 19000000\nX[tt,2] = 2\ntt <- X[,1] == 15 & X[,3] < 19000000 & X[,4] > 19000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 19000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 19000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 16 & X[,3] < 36600000 & X[,4] < 36600000\nX[tt,2] = 1\ntt <- X[,1] == 16 & X[,3] > 36600000 & X[,4] > 36600000\nX[tt,2] = 2\ntt <- X[,1] == 16 & X[,3] < 36600000 & X[,4] > 36600000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 36600000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 36600001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 17 & X[,3] < 24000000 & X[,4] < 24000000\nX[tt,2] = 1\ntt <- X[,1] == 17 & X[,3] > 24000000 & X[,4] > 24000000\nX[tt,2] = 2\ntt <- X[,1] == 17 & X[,3] < 24000000 & X[,4] > 24000000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 24000000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 24000001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 18 & X[,3] < 17200000 & X[,4] < 17200000\nX[tt,2] = 1\ntt <- X[,1] == 18 & X[,3] > 17200000 & X[,4] > 17200000\nX[tt,2] = 2\ntt <- X[,1] == 18 & X[,3] < 17200000 & X[,4] > 17200000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 17200000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 17200001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 19 & X[,3] < 26500000 & X[,4] < 26500000\nX[tt,2] = 1\ntt <- X[,1] == 19 & X[,3] > 26500000 & X[,4] > 26500000\nX[tt,2] = 2\ntt <- X[,1] == 19 & X[,3] < 26500000 & X[,4] > 26500000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 26500000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 26500001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 20 & X[,3] < 27500000 & X[,4] < 27500000\nX[tt,2] = 1\ntt <- X[,1] == 20 & X[,3] > 27500000 & X[,4] > 27500000\nX[tt,2] = 2\ntt <- X[,1] == 20 & X[,3] < 27500000 & X[,4] > 27500000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 27500000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 27500001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 21 & X[,3] < 13200000 & X[,4] < 13200000\nX[tt,2] = 1\ntt <- X[,1] == 21 & X[,3] > 13200000 & X[,4] > 13200000\nX[tt,2] = 2\ntt <- X[,1] == 21 & X[,3] < 13200000 & X[,4] > 13200000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 13200000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 13200001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 22 & X[,3] < 14700000 & X[,4] < 14700000\nX[tt,2] = 1\ntt <- X[,1] == 22 & X[,3] > 14700000 & X[,4] > 14700000\nX[tt,2] = 2\ntt <- X[,1] == 22 & X[,3] < 14700000 & X[,4] > 14700000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 14700000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 14700001, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\ntt <- X[,1] == 23 & X[,3] < 60950000 & X[,4] < 60950000\nX[tt,2] = 1\ntt <- X[,1] == 23 & X[,3] > 60950000 & X[,4] > 60950000\nX[tt,2] = 2\ntt <- X[,1] == 23 & X[,3] < 60950000 & X[,4] > 60950000\nX[tt,2] = 1\nB = X[tt,4]\nX[tt,4] = 60950000\nX=rbind(X[(1:which(tt==TRUE)),], c(X[tt,1], 2, 60950000, B, X[tt,5]) , X[-(1:which(tt==TRUE)),])\nrownames(X) <- NULL \n\nX[,2]<-X[,1]+(X[,2]-1)/2      \n\ntt=which(X$ratio_median==-Inf)\n\nif (length(tt) >= 1){\n  X=X[-tt,]  \n}\n\nX=as.matrix(X)\n\nL = dim(X)[1]\nA = matrix(0, ncol=6, nrow=L)\n\ni=1    \nc=1    \n\nwhile (i < L){\n  if(X[i,2]==X[i+1,2]){             \n    if (X[i,5]==X[i+1,5]){          \n      n=1\n      while (X[i,2]==X[i+n,2] & X[i,5]==X[i+n,5] & i+n < L){\n        n=n+1\n      }\n      if(i+n == L){\n        A[c,]=c(X[i,1], X[i,2], X[i,3], X[i+n,4], X[i,5], X[i+n,4]-X[i,3]+1) \n        i=i+n\n        c=c+1\n      }\n      else{\n        A[c,]=c(X[i,1], X[i,2], X[i,3], X[i+n-1,4], X[i,5], X[i+n-1,4]-X[i,3]+1) \n        i=i+n\n        c=c+1\n      }\n    }\n    else{\n      A[c,]=c(X[i,1], X[i,2], X[i,3], X[i,4], X[i,5], X[i,4]-X[i,3]+1)\n      i=i+1\n      c=c+1\n    }\n  }\n  else{\n    A[c,]=c(X[i,1], X[i,2], X[i,3], X[i,4], X[i,5], X[i,4]-X[i,3]+1)\n    i=i+1                                        \n    c=c+1                         \n  }  \n}\n\nA=subset(A, A[,1] != 0)\nrownames(A) <- NULL \ncolnames(A) <- c(\"chr\", \"chr_arm\", \"start\", \"end\", \"ratio_median\", \"size\")\n\n\nwrite.table(A, file = paste0(outputPath,\"/\",NAMEEE,\"_ratio_median_gathered.txt\"), sep = \"\\t\", row.names = FALSE)\n\noptions(show.error.messages = TRUE)"},"evals":[],"jsHooks":[]}</script>
<script type="application/htmlwidget-sizing" data-for="htmlwidget-8dbecb24d207105c4de3">{"viewer":{"width":450,"height":350,"padding":15,"fill":true},"browser":{"width":960,"height":500,"padding":40,"fill":false}}</script>
</body>
</html>
